<script>
  function updateCountdown() {
    fetch("https://waldocoin-backend-api.onrender.com/api/presale/end-date")
      .then(res => res.json())
      .then(data => {
        const countdownEl = document.getElementById("presale-countdown");
        const dateEl = document.getElementById("countdown-date");

        if (data.endDate) {
          const endDate = new Date(data.endDate);
          dateEl.textContent = endDate.toLocaleString("en-US", { timeZone: "UTC" }) + " UTC";

          function updateTimer() {
            const now = new Date();
            const diff = endDate - now;

            if (diff <= 0) {
              countdownEl.textContent = "EXPIRED";
              clearInterval(interval);
              return;
            }

            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
            const minutes = Math.floor((diff / (1000 * 60)) % 60);
            const seconds = Math.floor((diff / 1000) % 60);

            countdownEl.textContent =
              `${days}d ${hours}h ${minutes}m ${seconds}s`;
          }

          updateTimer();
          const interval = setInterval(updateTimer, 1000);
        } else {
          countdownEl.textContent = "Not Set";
          dateEl.textContent = "Not Available";
        }
      })
      .catch(err => {
        console.error("Countdown fetch error:", err);
        document.getElementById("presale-countdown").textContent = "Error";
        document.getElementById("countdown-date").textContent = "Fetch Error";
      });
  }

  document.addEventListener("DOMContentLoaded", updateCountdown);
</script>

